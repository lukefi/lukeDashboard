<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
<title>Luke - Economy doctor dashboard</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">-->
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/stylesGeneral.css">
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/stylesMap.css">
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/stylesGraph.css">
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/stylesSelectors.css">
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/stylesBoxSelector.css">
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/checkBoxes.css">
<link rel="stylesheet" href="https://pasoneto.github.io/lukeDashboard/styles/stylesMobile.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/leafLetFunctions.js"></script>

<script src="https://pasoneto.github.io/lukeDashboard/tt/data/regions.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/tt/customFunctions/customMaps.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/tt/customFunctions/customFunctions.js"></script>

</head>

<style>

#mapBox{
  width: 100vw;
  height: 100vh;
}
        .dropdown_button {
            width: 200px;
        }
 
        .courses {
            display: none;
            position: absolute;
            background-color: #f1f1f1;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            z-index: 1;
        }
 
        .courses li {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            list-style: none;
            background-color: rgb(47, 47, 47);
            font-family: montserrat;
            border: 1px solid white;
        }
 
        .courses li a {
            text-decoration: none;
            color: white;
            display: block;
            padding: 10px;
        }
 
        .courses li:hover {
            background-color: #0979ad;
            color: white;
        }

</style>
<body>
        <div class="dropdown_list">
            <button class="dropdown_button"
                onclick="show_list()">
                Select region division
            </button>
 
            <div id="courses_id" class="courses">
                <li><a name="Maakunta" onclick="wrapMap()">Maakunta</a></li>
                <li><a name="Municipality" onclick="wrapMap2()">Municipality</a></li>
            </div>
        </div>
<div id="mapBox"></div>
</body>

<script>
        function show_list() {
            var courses = document.getElementById("courses_id");
 
            if (courses.style.display == "block") {
                courses.style.display = "none";
            } else {
                courses.style.display = "block";
            }
        }
        window.onclick = function (event) {
            if (!event.target.matches('.dropdown_button')) {
                document.getElementById('courses_id')
                    .style.display = "none";
            }
        }  

  //Model JSON
  var geoModel = {
    "type": "FeatureCollection",
    "features": [],
    "totalFeatures": '',
    "numberMatched": '',
    "numberReturned": '',
    "timeStamp": "2022-08-30T21:57:56.647Z",
    "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:EPSG::4326" } }, 
    "bbox": []
  }

  var zoom = 5
  var centering = [65, 25]
  var map = L.map("mapBox", {zoomSnap: 0.1}).setView(centering, zoom);

  var baseTile = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
  })
  
  map.options.minZoom = 4;

  var tilesLayer; //Define another tile layer (not on use)
  var popup; //Define global popup layer

  async function wrapMap(){
    
    window.map.remove()
    window.map = L.map("mapBox", {zoomSnap: 0.1}).setView(centering, zoom);

    var regionDivision = 'maakunta'
    var [segmentedRegions, segmentedRegionsProps] = segmentRegions(regionsAll, regionDivision)
    var allFeatures = featureGenerator(segmentedRegions, segmentedRegionsProps)

    var geoJSON = generateGeoJSON(geoModel, allFeatures)

    L.geoJson(geoJSON, {
        onEachFeature: onEachFeature,
        style: styleGen,
      }).addTo(map);
  }

  async function wrapMap2(){

    window.map.remove()
    window.map = L.map("mapBox", {zoomSnap: 0.1}).setView(centering, zoom);

    var municipality = 'http://geo.stat.fi/geoserver/wfs?SERVICE=wfs&version=1.0.0&request=GetFeature&srsName=EPSG:4326&outputFormat=json&typeNames=kunta4500k_2022'
    var geoJSON = await loadArea(municipality)
    L.geoJson(geoJSON, {
        onEachFeature: onEachFeature,
        style: styleGen,
      }).addTo(map);
  }

  wrapMap(regionsAll)
</script>

<script src="https://pasoneto.github.io/lukeDashboard/src/generateHTMLstructure.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/tt/dataProcess.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/dataProcessUtils.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/graphFunctions.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/mapFunctions.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/dropdownSelection.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/shareFunctions.js"></script>
<script src="https://pasoneto.github.io/lukeDashboard/src/checkBoxSelectors.js"></script>
</html>
